<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:include="include :: header('退牧还草工程资金汇总报表')"/>
    <style>
        #china-map {
            width: 850px;
            height: 850px;
            margin: auto;
        }

        #box {
            display: none;
            background-color: goldenrod;
            width: 180px;
            height: 30px;
        }

        #box-title {
            display: block;
        }
    </style>
    <style type="text/css">
        body {
            background-color: rgba(144, 238, 144, 0.2);
        }

    </style>
</head>
<body class="gray-bg">
<div class="col-sm-18 select-table">

    <!--选项卡-->
    <div class="row">
        <div class="col-sm-12">
            <div class="tabs-container">
                <ul class="nav nav-tabs">
                    <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="false"> 折线图</a>
                    </li>
                    <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">柱状图</a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div id="tab-1" class="tab-pane active">
                        <div class="panel-body">
                            <div id="echarts-line-chart" style="width: 1300px;height:600px;"></div>

                        </div>
                    </div>
                    <div id="tab-2" class="tab-pane">
                        <div class="panel-body">
                            <div id="echarts-histogram-chart" style="width: 1300px;height:600px;"></div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--折线图-->
        <!-- <div  id="echarts-line-chart" style="width: 1300px;height:600px;"></div>-->

        <div class="col-sm-12 select-table table-bordered">
            <table id="bootstrap-table"></table>
        </div>
    </div>
    <th:block th:include="include :: footer"/>
    <th:block th:include="include :: echarts-js"/>

    <script th:inline="javascript">
        //var prefix = ctx + "system/summary";
        var prefix = ctx + "zaihai/fznbtj";




        layui.use('laydate', function () {
            var laydate = layui.laydate;

            //执行一个laydate实例
            laydate.render({
                elem: '#test2'
                , type: 'year'
            });
        });

        /*折线图*/
        $(function () {
            var grand=[[${grand}]]
            if(grand=='3'){
                var week = [];    //纵坐标数组（实际用来盛放Y坐标值）
                var province = [];
                var economicLoss=[];
                var livestockDeath=[];
                var hazardArea=[];
                var hazardAllArea=[];
                var controlDosage=[];
                var muDosage=[];
                var province = [[${province}]]

                var lineChart = echarts.init(document.getElementById("echarts-line-chart"));
                $.ajax({
                    type: "post",
                    async: true,            //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
                    url: prefix + "/getOption",    //请求发送到dataActiont处
                    data: {province: province},
                    dataType: "json",        //返回数据形式为json
                    success: function (result) {
                        //请求成功时执行该函数内容，result即为服务器返回的json对象
                        if (result) {

                            for (var i = 0; i < result.length; i++) {
                                economicLoss.push(result[i].economicLoss);
                                hazardArea.push(result[i].hazardArea);
                                hazardAllArea.push(result[i].hazardAllArea);
                                controlDosage.push(result[i].controlDosage);
                                muDosage.push(result[i].muDosage);
                                year.push(result[i].year);
                            }
                            lineChart.hideLoading();    //隐藏加载动画
                            lineChart.setOption({        //加载数据图表
                                title: {
                                    text: '发生年报统计折线图'
                                },
                                tooltip: {
                                    trigger: 'axis',

                                },
                                legend: {
                                    width: "70%",
                                    data: ['经济损失(万元)',  '其中工程区危害面积(万亩)', '危害总面积', '当年防治用量(亩/量)', '亩用量(亩/量)'],
                                },
                                calculable: true,
                                xAxis: {
                                    boundaryGap: false,
                                    data: year
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [
                                    {
                                        name: '经济损失(万元)',
                                        type: 'line',
                                        smooth: true,
                                        stack: '经济损失(万元)',
                                        data: economicLoss
                                    },

                                    {
                                        name: '其中工程区危害面积(万亩)',
                                        type: 'line',
                                        smooth: true,
                                        stack: '其中工程区危害面积(万亩)',
                                        data: hazardArea
                                    },
                                    {
                                        name: '危害总面积',
                                        type: 'line',
                                        smooth: true,
                                        stack: '危害总面积',
                                        data: hazardAllArea
                                    },
                                    {
                                        name: '当年防治用量(亩/量)',
                                        type: 'line',
                                        smooth: true,
                                        stack: '当年防治用量(亩/量)',
                                        data: controlDosage
                                    },
                                    {
                                        name: '亩用量(亩/量)',
                                        type: 'line',
                                        smooth: true,
                                        stack: '亩用量(亩/量)',
                                        data: muDosage
                                    }
                                ]

                            });
                            window.onresize = lineChart.resize;
                        }
                    },
                    error: function (errorMsg) {
                        //请求失败时执行该函数
                        alert("图表请求数据失败!");
                        lineChart.hideLoading();
                    }
                });
            }{
                var week = [];    //纵坐标数组（实际用来盛放Y坐标值）
                var province = [];
                var economicLoss=[];
                var livestockDeath=[];
                var hazardArea=[];
                var hazardAllArea=[];
                var controlDosage=[];
                var muDosage=[];
                var province = [[${province}]]

                var lineChart = echarts.init(document.getElementById("echarts-line-chart"));
                $.ajax({
                    type: "post",
                    async: true,            //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
                    url: prefix + "/getOption",    //请求发送到dataActiont处
                    data: {province: province},
                    dataType: "json",        //返回数据形式为json
                    success: function (result) {
                        //请求成功时执行该函数内容，result即为服务器返回的json对象
                        if (result) {

                            for (var i = 0; i < result.length; i++) {
                                economicLoss.push(result[i].economicLoss);
                                hazardArea.push(result[i].hazardArea);
                                hazardAllArea.push(result[i].hazardAllArea);
                                controlDosage.push(result[i].controlDosage);
                                muDosage.push(result[i].muDosage);
                                week.push(result[i].year);
                            }
                            lineChart.hideLoading();    //隐藏加载动画
                            lineChart.setOption({        //加载数据图表
                                title: {
                                    text: '发生年报统计折线图'
                                },
                                tooltip: {
                                    trigger: 'axis',

                                },
                                legend: {
                                    width: "70%",
                                    data: ['经济损失(万元)',  '其中工程区危害面积(万亩)', '危害总面积', '当年防治用量(亩/量)', '亩用量(亩/量)'],
                                },
                                calculable: true,
                                xAxis: {
                                    boundaryGap: false,
                                    data: week
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [
                                    {
                                        name: '经济损失(万元)',
                                        type: 'line',
                                        smooth: true,
                                        stack: '经济损失(万元)',
                                        data: economicLoss
                                    },

                                    {
                                        name: '其中工程区危害面积(万亩)',
                                        type: 'line',
                                        smooth: true,
                                        stack: '其中工程区危害面积(万亩)',
                                        data: hazardArea
                                    },
                                    {
                                        name: '危害总面积',
                                        type: 'line',
                                        smooth: true,
                                        stack: '危害总面积',
                                        data: hazardAllArea
                                    },
                                    {
                                        name: '当年防治用量(亩/量)',
                                        type: 'line',
                                        smooth: true,
                                        stack: '当年防治用量(亩/量)',
                                        data: controlDosage
                                    },
                                    {
                                        name: '亩用量(亩/量)',
                                        type: 'line',
                                        smooth: true,
                                        stack: '亩用量(亩/量)',
                                        data: muDosage
                                    }
                                ]

                            });
                            window.onresize = lineChart.resize;
                        }
                    },
                    error: function (errorMsg) {
                        //请求失败时执行该函数
                        alert("图表请求数据失败!");
                        lineChart.hideLoading();
                    }
                });
            }


        });

        /*柱状图*/
        $(function () {
            var grand=[[${grand}]]
            if(grand=='3'){
                var week = [];    //纵坐标数组（实际用来盛放Y坐标值）
                var province = [];
                var economicLoss=[];
                var livestockDeath=[];
                var hazardArea=[];
                var hazardAllArea=[];
                var controlDosage=[];
                var muDosage=[];


                var lineChart = echarts.init(document.getElementById("echarts-histogram-chart"));
                $.ajax({
                    type: "post",
                    async: true,            //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
                    url: prefix + "/getOptionHistogram",    //请求发送到dataActiont处
                    data: {province: province},
                    dataType: "json",        //返回数据形式为json
                    success: function (result) {
                        //请求成功时执行该函数内容，result即为服务器返回的json对象
                        if (result) {

                            for (var i = 0; i < result.length; i++) {
                                economicLoss.push(result[i].economicLoss);
                                livestockDeath.push(result[i].livestockDeath);
                                hazardArea.push(result[i].hazardArea);
                                hazardAllArea.push(result[i].hazardAllArea);
                                controlDosage.push(result[i].controlDosage);
                                muDosage.push(result[i].muDosage);
                                province.push(result[i].city);


                            }
                            lineChart.hideLoading();    //隐藏加载动画
                            lineChart.setOption({        //加载数据图表
                                title: {
                                    text: '发生年报统计柱状图'
                                },
                                tooltip: {
                                    trigger: 'line',

                                },
                                legend: {
                                    width: "70%",
/*
                                    data: ['经济损失(万元)', '家畜死亡(只/条/个)', '其中工程区危害面积(万亩)', '危害总面积', '当年防治用量(亩/量)', '亩用量(亩/量)'],
*/
                                },
                                calculable: true,
                                xAxis: {
                                    data: province
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [
                                    {
                                        name: '经济损失(万元)',
                                        type: 'bar',
                                        barWidth: 40,//柱图宽度
                                        stack: '经济损失(万元)',
                                        data: economicLoss
                                    },
                                    {
                                        name: '家畜死亡(只/条/个)',
                                        type: 'bar',
                                        barWidth: 40,//柱图宽度
                                        stack: '家畜死亡(只/条/个)',
                                        data: livestockDeath
                                    },
                                    {
                                        name: '其中工程区危害面积(万亩)',
                                        type: 'bar',
                                        barWidth: 40,//柱图宽度
                                        stack: '其中工程区危害面积(万亩)',
                                        data: hazardArea
                                    },
                                    {
                                        name: '危害总面积',
                                        type: 'bar',
                                        barWidth: 40,//柱图宽度
                                        stack: '危害总面积',
                                        data: hazardAllArea
                                    },
                                    {
                                        name: '当年防治用量(亩/量)',
                                        type: 'bar',
                                        barWidth: 40,//柱图宽度
                                        stack: '当年防治用量(亩/量)',
                                        data: controlDosage
                                    },
                                    {
                                        name: '亩用量(亩/量)',
                                        type: 'bar',
                                        barWidth: 40,//柱图宽度
                                        stack: '亩用量(亩/量)',
                                        data: muDosage
                                    }
                                ]

                            });
                            window.onresize = lineChart.resize;

                        }
                    },
                    error: function (errorMsg) {
                        //请求失败时执行该函数
                        alert("图表请求数据失败!");
                        lineChart.hideLoading();
                    }
                });
            }else{
                var week = [];    //纵坐标数组（实际用来盛放Y坐标值）
                var province = [];
                var economicLoss=[];
                var livestockDeath=[];
                var hazardArea=[];
                var hazardAllArea=[];
                var controlDosage=[];
                var muDosage=[];


                var lineChart = echarts.init(document.getElementById("echarts-histogram-chart"));
                $.ajax({
                    type: "post",
                    async: true,            //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
                    url: prefix + "/getOptionHistogram",    //请求发送到dataActiont处
                    data: {province: province},
                    dataType: "json",        //返回数据形式为json
                    success: function (result) {
                        //请求成功时执行该函数内容，result即为服务器返回的json对象
                        if (result) {

                            for (var i = 0; i < result.length; i++) {
                                economicLoss.push(result[i].economicLoss);
                                livestockDeath.push(result[i].livestockDeath);
                                hazardArea.push(result[i].hazardArea);
                                hazardAllArea.push(result[i].hazardAllArea);
                                controlDosage.push(result[i].controlDosage);
                                muDosage.push(result[i].muDosage);
                                province.push(result[i].province);


                            }
                            lineChart.hideLoading();    //隐藏加载动画
                            lineChart.setOption({        //加载数据图表
                                title: {
                                    text: '发生年报统计柱状图'
                                },
                                tooltip: {
                                    trigger: 'line',

                                },
                                legend: {
                                    width: "70%",
                                },
                                calculable: true,
                                xAxis: {
                                    data: province
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [
                                    {
                                        name: '经济损失(万元)',
                                        type: 'bar',
/*
                                        smooth: true,
*/
                                        barWidth: 40,//柱图宽度

                                        stack: '经济损失(万元)',
                                        data: economicLoss
                                    },
                                    {
                                        name: '家畜死亡(只/条/个)',
                                        type: 'bar',
                                        barWidth: 40,//柱图宽度
                                        stack: '家畜死亡(只/条/个)',
                                        data: livestockDeath
                                    },
                                    {
                                        name: '其中工程区危害面积(万亩)',
                                        type: 'bar',
                                        barWidth: 40,//柱图宽度
                                        stack: '其中工程区危害面积(万亩)',
                                        data: hazardArea
                                    },
                                    {
                                        name: '危害总面积',
                                        type: 'bar',
                                        barWidth: 40,//柱图宽度
                                        stack: '危害总面积',
                                        data: hazardAllArea
                                    },
                                    {
                                        name: '当年防治用量(亩/量)',
                                        type: 'bar',
                                        barWidth: 40,//柱图宽度
                                        stack: '当年防治用量(亩/量)',
                                        data: controlDosage
                                    },
                                    {
                                        name: '亩用量(亩/量)',
                                        type: 'bar',
                                        barWidth: 40,//柱图宽度
                                        stack: '亩用量(亩/量)',
                                        data: muDosage
                                    }
                                ]

                            });
                            window.onresize = lineChart.resize;

                        }
                    },
                    error: function (errorMsg) {
                        //请求失败时执行该函数
                        alert("图表请求数据失败!");
                        lineChart.hideLoading();
                    }
                });
            }


        });

    </script>
</body>
</html>