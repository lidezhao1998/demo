<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sinosoft.system.mapper.TTaskResolveMapper">
    
    <resultMap type="TTaskResolve" id="TTaskResolveResult">
        <result property="resolveId"    column="RESOLVE_ID"    />
        <result property="publishId"    column="PUBLISH_ID"    />
        <result property="parentId"    column="PARENT_ID"    />
        <result property="resolveCode"    column="RESOLVE_CODE"    />
        <result property="resolveLevel"    column="RESOLVE_LEVEL"    />
        <result property="year"    column="YEAR"    />
        <result property="province"    column="PROVINCE"    />
        <result property="address"    column="ADDRESS"    />
        <result property="addressId"    column="ADDRESS_ID"    />
        <result property="jmSize"    column="JM_SIZE"    />
        <result property="jmMoney"    column="JM_MONEY"    />
        <result property="xmSize"    column="XM_SIZE"    />
        <result property="xmMoney"    column="XM_MONEY"    />
        <result property="hqlxSize"    column="HQLX_SIZE"    />
        <result property="hqlxMoney"    column="HQLX_MONEY"    />
        <result property="bpSize"    column="BP_SIZE"    />
        <result property="bpMoney"    column="BP_MONEY"    />
        <result property="rgscdSize"    column="RGSCD_SIZE"    />
        <result property="rgscdMoney"    column="RGSCD_MONEY"    />
        <result property="hspjSize"    column="HSPJ_SIZE"    />
        <result property="hspjMoney"    column="HSPJ_MONEY"    />
        <result property="smhzlSize"    column="SMHZL_SIZE"    />
        <result property="smhzlMoney"    column="SMHZL_MONEY"    />
        <result property="thzyglSize"    column="THZYGL_SIZE"    />
        <result property="thzyglMoney"    column="THZYGL_MONEY"    />
        <result property="httSize"    column="HTT_SIZE"    />
        <result property="httMoney"    column="HTT_MONEY"    />
        <result property="ykcyzlSize"    column="YKCYZL_SIZE"    />
        <result property="ykcazlMoney"    column="YKCAZL_MONEY"    />
        <result property="dhcSize"    column="DHC_SIZE"    />
        <result property="dhcMoney"    column="DHC_MONEY"    />
        <result property="zyMoney"    column="ZY_MONEY"    />
        <result property="dfMoney"    column="DF_MONEY"    />
        <result property="createTime"    column="CREATE_TIME"    />
        <result property="createBy"    column="CREATE_BY"    />
        <result property="updateTime"    column="UPDATE_TIME"    />
        <result property="updateBy"    column="UPDATE_BY"    />
        <result property="status"    column="STATUS"    />
        <result property="delStatus"    column="DEL_STATUS"    />
    </resultMap>

    <sql id="selectTTaskResolveVo">
        select RESOLVE_ID, PUBLISH_ID, PARENT_ID, RESOLVE_CODE, RESOLVE_LEVEL, YEAR, PROVINCE, ADDRESS, ADDRESS_ID, JM_SIZE, JM_MONEY, XM_SIZE, XM_MONEY, HQLX_SIZE, HQLX_MONEY, BP_SIZE, BP_MONEY, RGSCD_SIZE, RGSCD_MONEY, HSPJ_SIZE, HSPJ_MONEY, SMHZL_SIZE, SMHZL_MONEY, THZYGL_SIZE, THZYGL_MONEY, HTT_SIZE, HTT_MONEY, YKCYZL_SIZE, YKCAZL_MONEY, DHC_SIZE, DHC_MONEY, ZY_MONEY, DF_MONEY, CREATE_TIME, CREATE_BY, UPDATE_TIME, UPDATE_BY, STATUS, DEL_STATUS from t_task_resolve
    </sql>

    <select id="selectTTaskResolveList" parameterType="TTaskResolve" resultMap="TTaskResolveResult">
        <include refid="selectTTaskResolveVo"/>
        <where>
            <if test="publishId != null "> and PUBLISH_ID = #{publishId}</if>
            <if test="parentId != null "> and PARENT_ID = #{parentId}</if>
            <if test="resolveCode != null  and resolveCode != ''"> and RESOLVE_CODE = #{resolveCode}</if>
            <if test="year != null  and year != ''"> and YEAR = #{year}</if>
            <if test="province != null  and province != ''"> and PROVINCE = #{province}</if>
            <if test="address != null  and address != ''"> and ADDRESS = #{address}</if>
            <if test="addressId != null  and addressId != ''"> and ADDRESS_ID = #{addressId}</if>
            <if test="jmSize != null "> and JM_SIZE = #{jmSize}</if>
            <if test="jmMoney != null "> and JM_MONEY = #{jmMoney}</if>
            <if test="xmSize != null "> and XM_SIZE = #{xmSize}</if>
            <if test="xmMoney != null "> and XM_MONEY = #{xmMoney}</if>
            <if test="hqlxSize != null "> and HQLX_SIZE = #{hqlxSize}</if>
            <if test="hqlxMoney != null "> and HQLX_MONEY = #{hqlxMoney}</if>
            <if test="bpSize != null "> and BP_SIZE = #{bpSize}</if>
            <if test="bpMoney != null "> and BP_MONEY = #{bpMoney}</if>
            <if test="rgscdSize != null "> and RGSCD_SIZE = #{rgscdSize}</if>
            <if test="rgscdMoney != null "> and RGSCD_MONEY = #{rgscdMoney}</if>
            <if test="hspjSize != null "> and HSPJ_SIZE = #{hspjSize}</if>
            <if test="hspjMoney != null "> and HSPJ_MONEY = #{hspjMoney}</if>
            <if test="smhzlSize != null "> and SMHZL_SIZE = #{smhzlSize}</if>
            <if test="smhzlMoney != null "> and SMHZL_MONEY = #{smhzlMoney}</if>
            <if test="thzyglSize != null "> and THZYGL_SIZE = #{thzyglSize}</if>
            <if test="thzyglMoney != null "> and THZYGL_MONEY = #{thzyglMoney}</if>
            <if test="httSize != null "> and HTT_SIZE = #{httSize}</if>
            <if test="httMoney != null "> and HTT_MONEY = #{httMoney}</if>
            <if test="ykcyzlSize != null "> and YKCYZL_SIZE = #{ykcyzlSize}</if>
            <if test="ykcazlMoney != null "> and YKCAZL_MONEY = #{ykcazlMoney}</if>
            <if test="dhcSize != null "> and DHC_SIZE = #{dhcSize}</if>
            <if test="dhcMoney != null "> and DHC_MONEY = #{dhcMoney}</if>
            <if test="zyMoney != null  and zyMoney != ''"> and ZY_MONEY = #{zyMoney}</if>
            <if test="dfMoney != null  and dfMoney != ''"> and DF_MONEY = #{dfMoney}</if>
            <if test="createTime != null "> and CREATE_TIME = #{createTime}</if>
            <if test="createBy != null  and createBy != ''"> and CREATE_BY = #{createBy}</if>
            <if test="updateTime != null "> and UPDATE_TIME = #{updateTime}</if>
            <if test="updateBy != null "> and UPDATE_BY = #{updateBy}</if>
            <if test="status != null  and status != ''"> and STATUS = #{status}</if>
            <if test="delStatus != null  and delStatus != ''"> and DEL_STATUS = #{delStatus}</if>
            and STATUS != '6' and RESOLVE_LEVEL = "2" and DEL_STATUS=1 order by CREATE_TIME desc
        </where>
    </select>

    <insert id="insertTTaskResolve" parameterType="TTaskResolve" useGeneratedKeys="true" keyProperty="resolveId">
        insert into t_task_resolve
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="publishId != null ">PUBLISH_ID,</if>
            <if test="parentId != null ">PARENT_ID,</if>
            <if test="resolveCode != null  and resolveCode != ''">RESOLVE_CODE,</if>
            <if test="resolveLevel != null  and resolveLevel != ''">RESOLVE_LEVEL,</if>
            <if test="year != null  and year != ''">YEAR,</if>
            <if test="province != null  and province != ''">PROVINCE,</if>
            <if test="address != null  and address != ''">ADDRESS,</if>
            <if test="addressId != null  and addressId != ''">ADDRESS_ID,</if>
            <if test="jmSize != null ">JM_SIZE,</if>
            <if test="jmMoney != null ">JM_MONEY,</if>
            <if test="xmSize != null ">XM_SIZE,</if>
            <if test="xmMoney != null ">XM_MONEY,</if>
            <if test="hqlxSize != null ">HQLX_SIZE,</if>
            <if test="hqlxMoney != null ">HQLX_MONEY,</if>
            <if test="bpSize != null ">BP_SIZE,</if>
            <if test="bpMoney != null ">BP_MONEY,</if>
            <if test="rgscdSize != null ">RGSCD_SIZE,</if>
            <if test="rgscdMoney != null ">RGSCD_MONEY,</if>
            <if test="hspjSize != null ">HSPJ_SIZE,</if>
            <if test="hspjMoney != null ">HSPJ_MONEY,</if>
            <if test="smhzlSize != null ">SMHZL_SIZE,</if>
            <if test="smhzlMoney != null ">SMHZL_MONEY,</if>
            <if test="thzyglSize != null ">THZYGL_SIZE,</if>
            <if test="thzyglMoney != null ">THZYGL_MONEY,</if>
            <if test="httSize != null ">HTT_SIZE,</if>
            <if test="httMoney != null ">HTT_MONEY,</if>
            <if test="ykcyzlSize != null ">YKCYZL_SIZE,</if>
            <if test="ykcazlMoney != null ">YKCAZL_MONEY,</if>
            <if test="dhcSize != null ">DHC_SIZE,</if>
            <if test="dhcMoney != null ">DHC_MONEY,</if>
            <if test="zyMoney != null  and zyMoney != ''">ZY_MONEY,</if>
            <if test="dfMoney != null  and dfMoney != ''">DF_MONEY,</if>
            <if test="createTime != null ">CREATE_TIME,</if>
            <if test="createBy != null  and createBy != ''">CREATE_BY,</if>
            <if test="updateTime != null ">UPDATE_TIME,</if>
            <if test="updateBy != null ">UPDATE_BY,</if>
            <if test="status != null  and status != ''">STATUS,</if>
            <if test="delStatus != null  and delStatus != ''">DEL_STATUS,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="publishId != null ">#{publishId},</if>
            <if test="parentId != null ">#{parentId},</if>
            <if test="resolveCode != null  and resolveCode != ''">#{resolveCode},</if>
            <if test="resolveLevel != null  and resolveLevel != ''">#{resolveLevel},</if>
            <if test="year != null  and year != ''">#{year},</if>
            <if test="province != null  and province != ''">#{province},</if>
            <if test="address != null  and address != ''">#{address},</if>
            <if test="addressId != null  and addressId != ''">#{addressId},</if>
            <if test="jmSize != null ">#{jmSize},</if>
            <if test="jmMoney != null ">#{jmMoney},</if>
            <if test="xmSize != null ">#{xmSize},</if>
            <if test="xmMoney != null ">#{xmMoney},</if>
            <if test="hqlxSize != null ">#{hqlxSize},</if>
            <if test="hqlxMoney != null ">#{hqlxMoney},</if>
            <if test="bpSize != null ">#{bpSize},</if>
            <if test="bpMoney != null ">#{bpMoney},</if>
            <if test="rgscdSize != null ">#{rgscdSize},</if>
            <if test="rgscdMoney != null ">#{rgscdMoney},</if>
            <if test="hspjSize != null ">#{hspjSize},</if>
            <if test="hspjMoney != null ">#{hspjMoney},</if>
            <if test="smhzlSize != null ">#{smhzlSize},</if>
            <if test="smhzlMoney != null ">#{smhzlMoney},</if>
            <if test="thzyglSize != null ">#{thzyglSize},</if>
            <if test="thzyglMoney != null ">#{thzyglMoney},</if>
            <if test="httSize != null ">#{httSize},</if>
            <if test="httMoney != null ">#{httMoney},</if>
            <if test="ykcyzlSize != null ">#{ykcyzlSize},</if>
            <if test="ykcazlMoney != null ">#{ykcazlMoney},</if>
            <if test="dhcSize != null ">#{dhcSize},</if>
            <if test="dhcMoney != null ">#{dhcMoney},</if>
            <if test="zyMoney != null  and zyMoney != ''">#{zyMoney},</if>
            <if test="dfMoney != null  and dfMoney != ''">#{dfMoney},</if>
            <if test="createTime != null ">#{createTime},</if>
            <if test="createBy != null  and createBy != ''">#{createBy},</if>
            <if test="updateTime != null ">#{updateTime},</if>
            <if test="updateBy != null ">#{updateBy},</if>
            <if test="status != null  and status != ''">#{status},</if>
            <if test="delStatus != null  and delStatus != ''">#{delStatus},</if>
         </trim>
    </insert>
    <select id="getIdByDate" resultMap="TTaskResolveResult">
        select PUBLISH_ID from t_task_resolve where YEAR=#{date} and DEL_STATUS=1 ORDER BY CREATE_TIME desc limit 1
    </select>
    <update id="updateTTaskResolve" parameterType="TTaskResolve">
        update t_task_resolve
        <trim prefix="SET" suffixOverrides=",">
            <if test="publishId != null ">PUBLISH_ID = #{publishId},</if>
            <if test="parentId != null ">PARENT_ID = #{parentId},</if>
            <if test="resolveCode != null  and resolveCode != ''">RESOLVE_CODE = #{resolveCode},</if>
            <if test="resolveLevel != null  and resolveLevel != ''">RESOLVE_LEVEL = #{resolveLevel},</if>
            <if test="year != null  and year != ''">YEAR = #{year},</if>
            <if test="province != null  and province != ''">PROVINCE = #{province},</if>
            <if test="address != null  and address != ''">ADDRESS = #{address},</if>
            <if test="addressId != null  and addressId != ''">ADDRESS_ID = #{addressId},</if>
            <if test="jmSize != null ">JM_SIZE = #{jmSize},</if>
            <if test="jmMoney != null ">JM_MONEY = #{jmMoney},</if>
            <if test="xmSize != null ">XM_SIZE = #{xmSize},</if>
            <if test="xmMoney != null ">XM_MONEY = #{xmMoney},</if>
            <if test="hqlxSize != null ">HQLX_SIZE = #{hqlxSize},</if>
            <if test="hqlxMoney != null ">HQLX_MONEY = #{hqlxMoney},</if>
            <if test="bpSize != null ">BP_SIZE = #{bpSize},</if>
            <if test="bpMoney != null ">BP_MONEY = #{bpMoney},</if>
            <if test="rgscdSize != null ">RGSCD_SIZE = #{rgscdSize},</if>
            <if test="rgscdMoney != null ">RGSCD_MONEY = #{rgscdMoney},</if>
            <if test="hspjSize != null ">HSPJ_SIZE = #{hspjSize},</if>
            <if test="hspjMoney != null ">HSPJ_MONEY = #{hspjMoney},</if>
            <if test="smhzlSize != null ">SMHZL_SIZE = #{smhzlSize},</if>
            <if test="smhzlMoney != null ">SMHZL_MONEY = #{smhzlMoney},</if>
            <if test="thzyglSize != null ">THZYGL_SIZE = #{thzyglSize},</if>
            <if test="thzyglMoney != null ">THZYGL_MONEY = #{thzyglMoney},</if>
            <if test="httSize != null ">HTT_SIZE = #{httSize},</if>
            <if test="httMoney != null ">HTT_MONEY = #{httMoney},</if>
            <if test="ykcyzlSize != null ">YKCYZL_SIZE = #{ykcyzlSize},</if>
            <if test="ykcazlMoney != null ">YKCAZL_MONEY = #{ykcazlMoney},</if>
            <if test="dhcSize != null ">DHC_SIZE = #{dhcSize},</if>
            <if test="dhcMoney != null ">DHC_MONEY = #{dhcMoney},</if>
            <if test="zyMoney != null  and zyMoney != ''">ZY_MONEY = #{zyMoney},</if>
            <if test="dfMoney != null  and dfMoney != ''">DF_MONEY = #{dfMoney},</if>
            <if test="createTime != null ">CREATE_TIME = #{createTime},</if>
            <if test="createBy != null  and createBy != ''">CREATE_BY = #{createBy},</if>
            <if test="updateTime != null ">UPDATE_TIME = #{updateTime},</if>
            <if test="updateBy != null ">UPDATE_BY = #{updateBy},</if>
            <if test="status != null  and status != ''">STATUS = #{status},</if>
            <if test="delStatus != null  and delStatus != ''">DEL_STATUS = #{delStatus},</if>
        </trim>
        where RESOLVE_ID = #{resolveId} and DEL_STATUS=1
    </update>

    <delete id="deleteTTaskResolveById" parameterType="Long">
        delete from t_task_resolve where PUBLISH_ID = #{resolveId}
    </delete>

    <delete id="deleteTTaskResolveByIds" parameterType="String">
        delete from t_task_resolve where RESOLVE_ID in
        <foreach item="resolveId" collection="array" open="(" separator="," close=")">
            #{resolveId}
        </foreach>
    </delete>

    <select id="selectTTaskResolveByPublishId" parameterType="TTaskResolve" resultMap="TTaskResolveResult">
        select * from t_task_resolve WHERE PUBLISH_ID = #{publishId} and  STATUS='3'
        <!-- 数据范围过滤 -->
    </select>
    <update id="updateTTaskResolveStatus" parameterType="TTaskResolve">
        update t_task_resolve set STATUS='1' where RESOLVE_ID = #{resolveId} and DEL_STATUS=1
    </update>
    <update id="removeResolveTTaskResolveByIds">
        update t_task_resolve  set  DEL_STATUS='0' where RESOLVE_ID in
        <foreach item="resolveId" collection="array" open="(" separator="," close=")">
            #{resolveId}
        </foreach>
    </update>

    <select id="selectTTaskResolveById" parameterType="Long" resultMap="TTaskResolveResult">
        <include refid="selectTTaskResolveVo"/>
        where RESOLVE_ID = #{resolveId} and DEL_STATUS=1
    </select>

    <select id="selectTTaskResolve" parameterType="TTaskResolve" resultMap="TTaskResolveResult">
        select * from t_task_resolve WHERE PUBLISH_ID = #{publishId} and  STATUS='3' or STATUS='6' and DEL_STATUS=1
        <!-- 数据范围过滤 -->
    </select>

    <select id="selectResolveTotalScale" parameterType="TTaskResolve" resultMap="TTaskResolveResult">
        SELECT JM_SIZE, JM_MONEY, XM_SIZE, XM_MONEY, HQLX_SIZE, HQLX_MONEY, RGSCD_SIZE, RGSCD_MONEY, HSPJ_SIZE, HSPJ_MONEY, SMHZL_SIZE, SMHZL_MONEY, THZYGL_SIZE, THZYGL_MONEY, HTT_SIZE, HTT_MONEY, YKCYZL_SIZE, YKCAZL_MONEY, DHC_SIZE, DHC_MONEY, ZY_MONEY, DF_MONEY,
        SUM(ifnull(JM_SIZE,'0'))+sum(ifnull(XM_SIZE,'0'))+sum(ifnull(HQLX_SIZE,'0'))+sum(ifnull(SMHZL_SIZE,'0'))+sum(ifnull(THZYGL_SIZE,'0'))+sum(ifnull(RGSCD_SIZE,'0'))+sum(ifnull(HSPJ_SIZE,'0'))+sum(ifnull(HTT_SIZE,'0'))+SUM(ifnull(DHC_SIZE,'0'))+sum(ifnull(YKCYZL_SIZE,'0')) as BP_SIZE
        FROM t_task_resolve
        WHERE RESOLVE_ID = #{resolveId} and DEL_STATUS=1
    </select>

    <select id="selectAreaResolveList" parameterType="TTaskResolve" resultMap="TTaskResolveResult">
        select PUBLISH_ID, YEAR, PROVINCE, ADDRESS, ADDRESS_ID, ifnull(JM_SIZE,'0') as JM_SIZE, ifnull(JM_MONEY,'0') as
        JM_MONEY, ifnull(XM_SIZE,'0') as XM_SIZE, ifnull(XM_MONEY,'0') as XM_MONEY, ifnull(HQLX_SIZE,'0') as HQLX_SIZE,
        ifnull(HQLX_MONEY,'0') as HQLX_MONEY, ifnull(BP_SIZE,'0') as BP_SIZE, BP_MONEY, ifnull(RGSCD_SIZE,'0') as
        RGSCD_SIZE, ifnull(RGSCD_MONEY,'0') as RGSCD_MONEY, ifnull(HSPJ_SIZE,'0') as HSPJ_SIZE, ifnull(HSPJ_MONEY,'0')
        as HSPJ_MONEY, ifnull(ZY_MONEY,'0') as ZY_MONEY, ifnull(DF_MONEY,'0') as DF_MONEY, ifnull(SMHZL_SIZE,'0') as
        SMHZL_SIZE, ifnull(SMHZL_MONEY,'0') as SMHZL_MONEY, ifnull(THZYGL_SIZE,'0') as THZYGL_SIZE,
        ifnull(THZYGL_MONEY,'0') as THZYGL_MONEY, ifnull(HTT_SIZE,'0') as HTT_SIZE, ifnull(HTT_MONEY,'0') as HTT_MONEY,
        ifnull(YKCYZL_SIZE,'0') as YKCYZL_SIZE, ifnull(YKCAZL_MONEY,'0') as YKCAZL_MONEY, ifnull(DHC_SIZE,'0') as
        DHC_SIZE, ifnull(DHC_MONEY,'0') as DHC_MONEY, DEL_STATUS , CREATE_TIME, UPDATE_TIME, UPDATE_BY, STATUS,
        CREATE_BY , ifnull(JM_SIZE,'0')+ ifnull(XM_SIZE,'0')+ ifnull(HQLX_SIZE,'0') + ifnull(SMHZL_SIZE,'0') as wlScale,
        ifnull( JM_SIZE, '0' ) + ifnull( XM_SIZE, '0' ) + ifnull( HQLX_SIZE, '0' ) + ifnull( SMHZL_SIZE, '0' )+
        ifnull( THZYGL_SIZE, '0' ) + ifnull( RGSCD_SIZE, '0' ) + ifnull( HSPJ_SIZE, '0' )+ ifnull( HTT_SIZE, '0' )+
        ifnull( DHC_SIZE, '0' )+ ifnull( YKCYZL_SIZE, '0' ) AS totalScale from t_task_resolve
        <where>
            <if test="year != null  and year != ''">and YEAR = #{year}</if>
            <if test="province != null  and province != ''">and PROVINCE = #{province}</if>
            and DEL_STATUS='1' order by CREATE_TIME desc
        </where>
    </select>
</mapper>