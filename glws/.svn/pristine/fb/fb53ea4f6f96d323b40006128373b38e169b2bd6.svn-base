<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>加载天地图</title>
    <th:block th:include="include :: header('地图')"/>
    <link th:href="@{/css/gis.css}" rel="stylesheet"/>
</head>
<body onLoad="onLoad()">
<div class="ui-layout-center">
    <div class="col-sm-12 search-collapse" id="savaInput">
        <input type="hidden" name="spotinfos" id="spotinfos" value=""><!--保存坐标信息-->
    </div>
    <div class="container-div">
        <div class="row">
            <div id="map">
                <div id="layerControl" class="layerControl">
                    <ul id="layerTree" class="layerTree"></ul>
                </div>
                <div class="header-r">
                    <div class="header-r-bg">
                        <a href="javascript:;" style="font-size: 16px;color:red" id="gisZoom"></a></strong>
                        <a href="javascript:;" id="comparison" onclick="comparison()">比对</a>
                        <a href="javascript:;" id="ranging" onclick="measurementGis('LineString')">测距</a>
                        <a href="javascript:;" id="measuringSurface" onclick="measurementGis('Polygon')">测面</a>
                        <a href="javascript:;" id="pointSerch" onclick="pointQuery()">点查</a>
                        <a href="javascript:;" id="locationShow">定位</a>
                    </div>
                </div>
                <div id="menu">
                    <div id="addGisMap">
                        <a href="javascript:;" onclick="drawGis('Point','map')">绘点</a>
                        <a href="javascript:;" onclick="drawGis('Polygon','map')">绘面</a>
                    </div>
                    <div id="delGisMap" style="display: none">
                        <a href="javascript:;" onclick="delGisMap()">重绘</a>
                        <a href="javascript:;" onclick="deleteMap()">删除绘图</a>
                    </div>
                    <input type="button" id="off"/>
                </div>
                <div id="menu3">
                    <input id="type3" value="全国" onclick="updateCity()"readonly>
                </div>
                <div class="layer_tree_show">
                    <div class="layer_tree_show_map"></div>
                </div>
                <div class="layer_tree_hide">
                    <i class="fa fa-chevron-left"></i>
                </div>
                <div class="west">
                    <div class="box box-main">
                        <div class="ui-layout-content" style="height: 420px">
                            <div id="businessLayer" class="ztree" style="overflow-x: scroll;height: 200px;"></div>
                            <div id="thematicLayer" class="ztree" style="overflow-x: scroll;height: 200px;"></div>
                        </div>
                    </div>
                </div>
                <div id="dist_positioning">
                    <p id="title_zq"><span>地区定位</span> <span onclick="cityDivDoneById('dist_positioning')"
                                                             style="float: right;margin: 0 10px;cursor: pointer;">关闭</span>
                    </p>
                    <div id="zqdw"><p class="content_ul" style="color: #13c6ae;">全国</p></div>
                    <ul class="zq_ul"></ul>
                </div>
                <div id="shpTitle" class="col-sm-12 select-table table-striped">
                    <table id="bootstrap-table">
                    </table>
                </div>
                <!--定位-->
                <div class="coordinatePositioning">
                    <li class="clear li-dw selected" style="display: block;">
                        <span class="zs-left icon icon-dw"></span>
                        <div class="zs-left module" style="display: block;">

                            <div class="ori-module-content module-content" style="display: block;padding-left: 50px;">
                                <table class="jwd tabls" style="display: table;">
                                    <tr>
                                        <td class="text">经度：</td>
                                        <td class="input"><input id="decimalLon" value="" class="form-control sea-input" placeholder="例:11.1" onkeyup="value=value.replace(/^\D*(\d*(?:\.\d{0,2})?).*$/g, '$1')" ></td>
                                    </tr>
                                    <tr>
                                        <td class="text">纬度：</td>
                                        <td class="input"><input id="decimalLat" value="" class="form-control sea-input" placeholder="例:23.1" onkeyup="value=value.replace(/^\D*(\d*(?:\.\d{0,2})?).*$/g, '$1')" ></td>
                                    </tr>
                                </table>
                                <div class="dw-box" style="margin-top: 15px;">
                                    <button type="button" class="btn btn-primary" id="positioning_btn">定位</button>
                                    <button type="button" class="btn btn-danger" id="closePositioning">关闭</button>
                                </div>
                            </div>
                        </div>
                    </li>
                </div>
            </div>
            <div id="map-left" style="display: none">
                <div class="layer_tree_show">
                    <div class="layer_tree_show_map_left"></div>
                </div>
                <div class="layer_tree_hide_left">
                    <i class="fa fa-chevron-left"></i>
                </div>
                <div class="west-left">
                    <div class="box box-main">
                        <div class="ui-layout-content" style="height: 420px">
                            <div id="businessLayer_left" class="ztree" style="overflow-x: scroll;height: 200px;"></div>
                            <div id="thematicLayer_left" class="ztree" style="overflow-x: scroll;height: 200px;"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="map-right" style="display: none">
                <div class="header-r">
                    <div class="header-r-bg">
                        <a href="javascript:;" id="gisQuit" onclick="gisQuit()">退出</a>
                    </div>
                </div>
                <div class="layer_tree_show">
                    <div class="layer_tree_show_map_right"></div>
                </div>
                <div class="layer_tree_hide_right">
                    <i class="fa fa-chevron-left"></i>
                </div>
                <div class="west-right">
                    <div class="box box-main">
                        <div class="ui-layout-content" style="height: 420px">
                            <div id="businessLayer_right" class="ztree" style="overflow-x: scroll;height: 200px;"></div>
                            <div id="thematicLayer_right" class="ztree" style="overflow-x: scroll;height: 200px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="mouse-position">
    </div>
</div>
</body>
<th:block th:include="include :: footer"/>
<th:block th:include="include :: layout-latest-css"/>
<th:block th:include="include :: ztree-css"/>
<th:block th:include="include :: layout-latest-js"/>
<th:block th:include="include :: ztree-js"/>
<script th:src="@{/js/gis/sinosoftGis.js}"></script>
<script th:src="@{/js/gis/gisComparison.js}"></script>
<script th:inline="javascript">
    var lngLat = [[${lngLat}]];
    var mapId = [[${mapId}]];
    var gisLonLat=[[${lngLat}]];
</script>
<script type="text/javascript">
    var prefixGisMap = ctx + "system/gisMap";
    $(function () {
        var panehHidden = false;
        if ($(this).width() < 769) {
            panehHidden = true;
        }
        $('body').layout({initClosed: panehHidden, west__size: 185});
    });

    function onLoad() {
        load();
        var view = map.getView();
        if(lngLat!=null && lngLat!='null'){
            var cent= lngLat.split(",");
            view.setZoom(10);
            view.setCenter([parseFloat(cent[0]), parseFloat(cent[1])]);
        }
        if(mapId!=null && mapId!='null'){
            if(mapId==-1){
                $("#delGisMap").hide();
                $("#addGisMap").hide();
            }else{
                $("#delGisMap").show();
                $("#addGisMap").hide();
                loadgisByGid(mapId);
            }
        }
    }
    function deleteMap() {
        $.get(prefixGisMap+"/delete?gisId="+mapId,function (res) {
            clearGis(map);
            $("#delGisMap").hide();
            $("#addGisMap").show();
            mapId=null;
            sessionStorage.setItem("gis_id", "");
            layer.msg("删除成功", {icon: 6, time: 2000});
        })
    }
    function delGisMap(){
        clearGis(map);
        $("#delGisMap").hide();
        $("#addGisMap").show();
        //移除绘制图形
        if(pointQueryName!=null && pointQueryName.length>0){
            for(var i=0;i<pointQueryName.length;i++){
                ol.Observable.unByKey(pointQueryName[i]);
            }
        }
    }
</script>
<style type="text/css">
    body, html {
        width: 100%;
        height: 100%;
        margin: 0;
        font-family: "微软雅黑";
    }
    #map {
        height: 100%;
        width: 100%;
    }
    #savaInput {
        float: right;
        margin-top: 0px;
        padding-top: 0px;
        padding-bottom: 0px;
    }
    #menu {
        float: right;
        position: absolute;
        bottom: 94%;
        right: 50%;
        z-index: 2000;
    }
    #dist_positioning ul{
        padding: 0px;
    }
    #dist_positioning ul li {
        float: left;
        width: 90px;
        min-width: 90px;
        text-align: center;
        line-height: 25px;
        padding: 0 8px;
        margin: 2px;
        font-size: 14px;
        cursor: pointer;
        border: 1px solid #efefef;
        word-break: keep-all;
        list-style: none;
    }
    input, b {
        margin-left: 5px;
        font-size: 14px
    }
    input {
        margin-top: 10px;
        margin-left: 5px;
        font-size: 14px;
        text-align: center;
    }
    /* 鼠标位置控件层样式设置 */
    #mouse-position {
        float: right;
        position: absolute;
        left: 40%;
        bottom: 5px;
        width: 200px;
        height: 20px;
        /*在地图容器中的层，要设置z-index的值让其显示在地图上层*/
        z-index: 2000;
    }
    #dist_positioning p {
        width: 100%;
        height: 35px;
        line-height: 35px;
        padding-left: 20px;
        font-size: 14px;
        background: #f7f7f7;
    }
    #zqdw .content_ul {
        width: auto;
        min-width: 50px;
        height: 30px;
        line-height: 30px;
        font-size: 12px;
    }
    /* 鼠标位置信息自定义样式设置 */
    .custom-mouse-position {
        color: rgb(0,0,0);
        font-size: 18px;
        font-family: "微软雅黑";
    }
    /**
   * 提示框的样式信息
   */
    .tooltip {
        position: relative;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 4px;
        color: white;
        padding: 4px 8px;
        opacity: 0.7;
        white-space: nowrap;
    }

    .tooltip-measure {
        opacity: 1;
        font-weight: bold;
    }

    .tooltip-static {
        background-color: #ffcc33;
        color: black;
        border: 1px solid white;
    }

    .tooltip-measure:before,
    .tooltip-static:before {
        border-top: 6px solid rgba(0, 0, 0, 0.5);
        border-right: 6px solid transparent;
        border-left: 6px solid transparent;
        content: "";
        position: absolute;
        bottom: -6px;
        margin-left: -7px;
        left: 50%;
    }

</style>
</html>
