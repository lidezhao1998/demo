<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <th:block th:include="include :: header('鼠虫害危害情况')" />
</head>
<style>
    /*修改表头颜色*/
    .table-striped table thead{
        background-color:rgba(48,146,62, 0.9);
        color: whitesmoke;
        height: 55px;
    }

    /*按钮背景色*/
    .btn-success{

        background-color:rgba(48,146,62, 0.9);

    }
</style>
<body class="gray-bg">
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="col-sm-10 search-collapse">
        <div class="select-list">
            <ul>
                <li>

                    选择类型:<select  id="type" name="type">
                        <option th:value ="虫害">虫害</option>
                        <option th:value ="鼠害">鼠害</option>
                    </select>

                </li>
                <li>
                    系数：<input type="text" id="xs" name="xs" th:value="${xs}"/>
                </li>
                <li>
                    <a id="search" name="search" class="btn btn-primary btn-rounded btn-sm">&nbsp;设置</a>
                    <a class="btn btn-warning btn-rounded btn-sm" onclick="$.form.reset('recoveryquestion-form')"><i class="fa fa-refresh"></i>&nbsp;重置</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="ibox float-e-margins">
        <div class="ibox-content">
            <div class="echarts" id="echarts-line-chart"></div>
        </div>
        <div class="col-sm-12 select-table table-striped">
            <table id="bootstrap-table"></table>
        </div>
    </div>
</div>

<th:block th:include="include :: footer" />
<th:block th:include="include :: echarts-js" />
<script type="text/javascript">
    var prefix = ctx + "analysis/trendForecast";
    $(function () {
        var message="[[${message}]]";
        if(message!=""){
        }
        var lineChart = echarts.init(document.getElementById("echarts-line-chart"));
        var lineoption = {
            tooltip : {
                trigger: 'axis'
            },
            legend: {
                data:['危害总面积','危害面积发生预测']
            },
            grid:{
                x:40,
                x2:40,
                y2:24
            },
            calculable : true,
            xAxis : [
                {
                    type : 'category',
                    boundaryGap : false,
                    data : [[${years}]]
                }
            ],
            yAxis : [
                {
                    type : 'value',
                    name: '亩',
                    axisLabel : {
                        margin:-3,
                        formatter: '{value}'
                    },
                    grid: {
                        left: 35
                    }
                }
            ],
            series : [
                {
                    name:'危害总面积',
                    type:'line',
                    data: [[${values}]],
                    markPoint : {
                        data : [
                            {type : 'max', name: '最大值'},
                            {type : 'min', name: '最小值'}
                        ]
                    }
                    ,
                    markLine : {
                        data : [
                            {type : 'average', name: '平均值'}
                        ]
                    }
                },
                {
                    name:'危害面积发生预测',
                    type:'line',
                    color:"#14d146",
                    data: [[${anaData}]]
                }
            ]
        };
        lineChart.setOption(lineoption);
        $(window).resize(lineChart.resize);

        var options = {
            showSearch: false,
            showToggle: false,
            showColumns: false,
            showRefresh: false,
            pageSize:5,
            pageList:[5,10,15,20],//分页步进值
            url: prefix + "/list",
            sortName: "creatTime",
            sortOrder: "desc",
            modalName: "危害发生面积",
            columns: [
                {
                    field: 'id',
                    title: 'ID',
                    align: 'center',
                    valign: 'middle'
                },
                {
                    field: 'type',
                    align: 'center',
                    valign: 'middle',
                    title: '危害面积类型'
                },
                {
                    field: 'year',
                    align: 'center',
                    valign: 'middle',
                    title: '年份'
                },
                {
                    field: 'harmTotalarea',
                    align: 'center',
                    valign: 'middle',
                    title: '危害总面积'
                }
            ]
        };
        $.table.init(options);


    });
    $('#search').click(function () {
        var xs=$("#xs").val();
        var type=$("#type").val();
/*
        alert(JSON.stringify(type))
*/
        if(!isNaN(xs)){
            if(0>=xs){
                alert("请输入0到1之间的数");
            }else if(xs>=1){
                alert("请输入0到1之间的数");
            }else{
                window.location.href=prefix+"?xs="+xs+"&type="+type;
            }
        }else{
            alert("请输入0到1之间的数");
        }
    })

</script>
</body>
</html>