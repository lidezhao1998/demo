<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>加载天地图</title>
    <th:block th:include="include :: header('地图')"/>
</head>
<body onLoad="onLoad()">
<div class="ui-layout-center">
    <div class="col-sm-12 search-collapse" id="savaInput">
        <input type="hidden" name="spotinfos" id="spotinfos" value=""><!--保存坐标信息-->
    </div>
    <div class="container-div">
        <div class="row">
            <div id="map">
                <div id="menu">
                    <div id="addGisMap">
                        <label style="cursor: pointer;color: #13c6ae;font-size: 18px" onclick="drawGis('Point','map')">绘点</label>
                        <label style="cursor: pointer;color: #13c6ae;font-size: 18px" onclick="drawGis('Polygon','map')">绘面</label>
                    </div>
                    <div id="delGisMap" style="display: none">
                        <label style="cursor: pointer;color: #13c6ae;font-size: 18px" onclick="delGisMap()">重绘</label>
                        <label style="cursor: pointer;color: #13c6ae;font-size: 18px" onclick="deleteMap()">删除绘图</label>
                    </div>
                    <input type="button" id="off" style="cursor: pointer;color: #13c6ae;font-size: 16px;display: none"/>
                </div>
            </div>
        </div>
    </div>
    <div id="mouse-position">
    </div>
</div>
</div>
</body>
<th:block th:include="include :: footer"/>
<th:block th:include="include :: layout-latest-css"/>
<th:block th:include="include :: ztree-css"/>
<th:block th:include="include :: layout-latest-js"/>
<th:block th:include="include :: ztree-js"/>
<script th:inline="javascript">
    var lngLat = [[${lngLat}]];
    var mapId = [[${mapId}]];
</script>
<script type="text/javascript">
    var prefixGisMap = ctx + "system/gisMap";
    $(function () {
        var panehHidden = false;
        if ($(this).width() < 769) {
            panehHidden = true;
        }
        $('body').layout({initClosed: panehHidden, west__size: 185});
    });

    function onLoad() {
        load();
        var view = map.getView();
        if(lngLat!=null && lngLat!='null'){
            var cent= lngLat.split(",");
            view.setZoom(10);
            view.setCenter([parseFloat(cent[0]), parseFloat(cent[1])]);
        }
        if(mapId!=null && mapId!='null'){
            if(mapId==-1){
                $("#delGisMap").hide();
                $("#addGisMap").hide();
            }else{
                $("#delGisMap").show();
                $("#addGisMap").hide();
                loadgisByGid(mapId);
            }

        }
    }
    function deleteMap() {
        $.get(prefixGisMap+"/deleteMap?id="+mapId,function (res) {
            clearGis();
            $("#delGisMap").hide();
            $("#deleteMap").hide();
            mapId=null;
            sessionStorage.setItem("gis_id", "");
            layer.msg("删除成功", {icon: 6, time: 2000});
        })
    }
   function delGisMap(){
            clearGis();
       $("#delGisMap").hide();
       $("#addGisMap").show();
       //移除绘制图形
       if(pointQueryName!=null && pointQueryName.length>0){
           for(var i=0;i<pointQueryName.length;i++){
               ol.Observable.unByKey(pointQueryName[i]);
           }
       }
    }
</script>
<style type="text/css">
    body, html {
        width: 100%;
        height: 100%;
        margin: 0;
        font-family: "微软雅黑";
    }
    #map {
        height: 100%;
        width: 100%;
    }
    #savaInput {
        float: right;
        margin-top: 0px;
        padding-top: 0px;
        padding-bottom: 0px;
    }
    #menu {
        float: right;
        position: absolute;
        bottom: 94%;
        right: 50%;
        z-index: 2000;
    }
    #dist_positioning ul{
        padding: 0px;
    }
    #dist_positioning ul li {
        float: left;
        width: 90px;
        min-width: 90px;
        text-align: center;
        line-height: 25px;
        padding: 0 8px;
        margin: 2px;
        font-size: 14px;
        cursor: pointer;
        border: 1px solid #efefef;
        word-break: keep-all;
        list-style: none;
    }
    input, b {
        margin-left: 5px;
        font-size: 14px
    }
    input {
        margin-top: 10px;
        margin-left: 5px;
        font-size: 14px;
        text-align: center;
    }
    /* 鼠标位置控件层样式设置 */
    #mouse-position {
        float: right;
        position: absolute;
        left: 40%;
        bottom: 5px;
        width: 200px;
        height: 20px;
        /*在地图容器中的层，要设置z-index的值让其显示在地图上层*/
        z-index: 2000;
    }
    #dist_positioning p {
        width: 100%;
        height: 35px;
        line-height: 35px;
        padding-left: 20px;
        font-size: 14px;
        background: #f7f7f7;
    }
    #zqdw .content_ul {
        width: auto;
        min-width: 50px;
        height: 30px;
        line-height: 30px;
        font-size: 12px;
    }
    /* 鼠标位置信息自定义样式设置 */
    .custom-mouse-position {
        color: rgb(0,0,0);
        font-size: 18px;
        font-family: "微软雅黑";
    }
    /**
   * 提示框的样式信息
   */
    .tooltip {
        position: relative;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 4px;
        color: white;
        padding: 4px 8px;
        opacity: 0.7;
        white-space: nowrap;
    }

    .tooltip-measure {
        opacity: 1;
        font-weight: bold;
    }

    .tooltip-static {
        background-color: #ffcc33;
        color: black;
        border: 1px solid white;
    }

    .tooltip-measure:before,
    .tooltip-static:before {
        border-top: 6px solid rgba(0, 0, 0, 0.5);
        border-right: 6px solid transparent;
        border-left: 6px solid transparent;
        content: "";
        position: absolute;
        bottom: -6px;
        margin-left: -7px;
        left: 50%;
    }

</style>
</html>
