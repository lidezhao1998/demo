<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" >
<head>
    <th:block th:include="include :: header('新增科技成果信息')" />
    <th:block th:include="include :: datetimepicker-css" />
    <th:block th:include="include :: bootstrap-fileinput-css" />
</head>
<style>
    .required:after {
        position: absolute;
        top: 3px;
        right: 0px;
        display: inline-block;
        font-size: 28px;
        color: #d2322d;
        content: '*';
    }
</style>
<body class="white-bg">
    <div class="wrapper wrapper-content animated fadeInRight ibox-content">
        <form class="form-horizontal m" id="form-technology-add">
            <div class="row">

                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-3 control-label"><span style="color: red; ">*</span>成果名称：</label>
                        <div class="col-sm-8">
                            <input name="name" class="form-control" type="text" required>
                        </div>
                    </div>
                </div>


                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-3 control-label"><span style="color: red; ">*</span>所属技术领域：</label>
                        <div class="col-sm-8">
                            <input name="technicalField" class="form-control" type="text" required>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-3 control-label"><span style="color: red; ">*</span>提交人：</label>
                        <div class="col-sm-8">
                            <input name="sumbitter" class="form-control" type="text" required>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">Email：</label>
                        <div class="col-sm-8">
                            <input id="email" name="email" class="form-control email" type="text" maxlength="50" placeholder="请输入邮箱" required>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">地址：</label>
                        <div class="col-sm-8">
                            <input name="address" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-3 control-label"><span style="color: red; ">*</span>联系方式：</label>
                        <div class="col-sm-8">
                            <input id="phone" name="phone" placeholder="请输入手机号码" class="form-control" type="text" maxlength="11" required>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
            <div class="form-group">
                <label class="col-sm-3 control-label">邮政编码：</label>
                <div class="col-sm-8">
                    <input name="fax" id="fax" th:onchange="ischeck()"  class="form-control" type="text" maxlength="6">
                </div>
            </div>
                </div>

                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">创建时间：</label>
                        <div class="col-sm-8">
                            <div class="input-group date">
                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                <input name="creatTime" class="form-control" placeholder="yyyy-MM-dd" type="text">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">研发方式：</label>
                        <div class="col-sm-8">
                            <input name="rdmethods" class="form-control" type="text" >
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">合作方式：</label>
                        <div class="col-sm-8">
                            <input name="cooperationMethod" class="form-control" type="text" >
                        </div>
                    </div>
                </div>
            </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label class="col-sm-3 control-label">成果应用情况：</label>
                            <div class="col-sm-8">
                                <input name="resultsApplication" class="form-control" type="text">
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label class="col-sm-3 control-label">实施成果转化需求：</label>
                            <div class="col-sm-8">
                                <input name="demand" class="form-control" type="text">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label class="col-sm-3 control-label">成果应用行业：</label>
                            <div class="col-sm-8">
                                <input name="industry" class="form-control" type="text">
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label class="col-sm-3 control-label">获奖类别：</label>
                            <div class="col-sm-8">
                                <input name="awardCategory" class="form-control" type="text">
                            </div>
                        </div>
                    </div>
                </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">获奖级别：</label>
                        <div class="col-sm-8">
                            <input name="awardLevel" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">技术成熟度：</label>
                        <div class="col-sm-8">
                            <input name="technologyMaturity" class="form-control" type="text" >
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label class="col-sm-3 control-label">填报时间：</label>
                            <div class="col-sm-8">
                                <div class="input-group date">
                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    <input name="inputTime" class="form-control" placeholder="yyyy-MM-dd" type="text">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="form-group">
                    <label class="font-noraml">文件上传</label>
                    <div class="file-loading">
                        <input class="file" type="file" multiple data-min-file-count="1" data-theme="fas">
                    </div>
                </div>
            </div>
        </form>
        <div class="button-b" style="margin-left: 35%" id="button-set">
            <button type="button" class="btn btn-w-m btn-primary" onclick="saveup()"id="saveup" >保存并上报</button>
            <button type="button" class="btn btn-w-m btn-primary" onclick="save()"id="save" >保 存</button>
            <button type="button" class="btn btn-w-m btn-danger" onclick="closeItem()" >关 闭</button>
        </div>
    </div>
    <th:block th:include="include :: footer" />
    <th:block th:include="include :: datetimepicker-js" />
    <th:block th:include="include :: bootstrap-fileinput-js" />
    <script type="text/javascript">
        var prefix = ctx + "system/technology";
        $("#form-technology-add").validate({

        onkeyup: false,
            rules:{
                email:{
                    email:true,

                },
                phone:{
                    isPhone:true,

                },
                PostalCode:{
                    PostalCode:true,
                }
            },
            focusCleanup: true
        });

              /**********验证邮政编码的有效性***********/

      /*  function ischeck(){
            var postcode = document.getElementById("fax").value;
            if (postcode != "") {   //邮政编码判断
                var pattern = /^[0-9]{6}$/;
                flag = pattern.test(postcode);
                if (!flag) {
                    alert("非法的邮政编码！")
                    document.getElementById("postcode").focus();
                    return false;
                }
            }
        }
*/
        $(document).ready(function () {
            $("#fileinput-demo-1").fileinput({
                'theme': 'explorer-fas',
                'uploadUrl': '#',
                overwriteInitial: false,
                initialPreviewAsData: true,
                initialPreview: [
                    ""
                ]
            });
        });

        function submitHandler() {
            if ($.validate.form()) {
                $.operate.save(prefix + "/add", $('#form-technology-add').serialize());
            }
        }

        function save() {
            if ($.validate.form()) {
                $.modal.confirm("确认要点击确定吗?", function () {
                    saveTab(prefix + "/add", $('#form-technology-add').serialize());
                });
            }
        }
        function saveTab(url, data, callback) {
            var config = {
                url: url,
                type: "post",
                dataType: "json",
                data: data,
                beforeSend: function () {
                    $.modal.loading("正在处理中，请稍后...");
                },
                success: function(result) {
                    if (typeof callback == "function" ) {
                        callback(result);
                    }
                    if (result.code == web_status.SUCCESS) {
                        confirmdemo(result.msg,function() {
                            reload();
                        });
                    } else if (result.code == web_status.WARNING) {
                        $.modal.alertWarning(result.msg)
                    } else {
                        $.modal.alertError(result.msg);
                    }
                    $.modal.closeLoading();
                }
            };
            $.ajax(config)
        }
        function saveup(){
            if ($.validate.form()) {
                $.modal.confirm("确认要点击确定吗?", function () {
                    saveModal(prefix + "/add1", $('#form-technology-add').serialize());
                });
            }
        }
        $("input[name='creatTime']").datetimepicker({
            format: "yyyy-mm-dd",
            minView: "month",
            autoclose: true
        }); $("input[name='inputTime']").datetimepicker({
            format: "yyyy-mm-dd",
            minView: "month",
            autoclose: true
        });
        $("input[name='inputTime']").datetimepicker({
            format: "yyyy-mm-dd",
            minView: "month",
            autoclose: true
        });
        function confirmdemo(content, callBack) {
            layer.confirm(content, {
                icon: 3,
                title: "系统提示",
                btn: ['确认']
            },  function (index) {
                layer.close(index);

                callBack(true);

            });
        };

        // 保存信息 弹出提示框
        function saveModal(url, data, callback) {
            var config = {
                url: url,
                type: "post",
                dataType: "json",
                data: data,
                success: function(result) {
                    if (typeof callback == "function" ) {
                        callback(result);
                    }
                    if (result.code == web_status.SUCCESS) {
                        confirmdemo(result.msg,function() {
                            reload();
                        });
                    } else if (result.code == web_status.WARNING) {
                        $.modal.alertWarning(result.msg)
                    } else {
                        $.modal.alertError(result.msg);
                    }
                    $.modal.closeLoading();

                }
            };
            $.ajax(config)
        }
        function reload () {
            parent.location.reload();
        }
    </script>
</body>
</html>