<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sinosoft.extinterface.mapper.WeatherStationMapper">

    <resultMap type="com.sinosoft.extinterface.domain.WeatherStation" id="WeatherStation">
        <id property="id" column="id"/>
        <result property="longitude" column="lon"/>
        <result property="latitude" column="lat"/>
        <result property="siteName" column="site_name"/>
        <result property="siteCode" column="site_code"/>
        <result property="weather" column="weather"/>
        <result property="county" column="county"/>
        <result property="city" column="city"/>
        <result property="minTemperature" column="min_temperature"/>
        <result property="maxTemperature" column="max_temperature"/>
        <result property="province" column="province"/>
    </resultMap>
    <sql id="selectWeatherstation">
        select d.id,
               d.longitude,
               d.latitude,
               d.site
        from a_weatherstation_interface d
    </sql>
    <update id="updateaddFields">
      UPDATE a_weather_stations
        <set>
            <if test="province!=null and province!=''">
                province =#{province},
            </if>
            <if test="city!=null and city!=''">
                city =#{city},
            </if>
            <if test="county!=null and county!=''">
                county =#{county},
            </if>
            <if test="provinceCode!=null and provinceCode!=''">
                province_code =#{provinceCode},
            </if>
            <if test="cityCode!=null and cityCode!=''">
                city_code =#{cityCode},
            </if>
            <if test="countyCode!=null and countyCode!=''">
                county_code =#{countyCode},
            </if>
            <if test="minTemperature!=null and minTemperature!=''">
                min_temperature =#{minTemperature},
            </if>
            <if test="maxTemperature!=null and maxTemperature!=''">
                max_temperature =#{maxTemperature},
            </if>
            <if test="weather!=null and weather!=''">
                weather =#{weather},
            </if>

        </set>
        where id=#{id}
    </update>

    <select id="selectWeatherStationList" parameterType="com.sinosoft.extinterface.domain.WeatherStation" resultMap="WeatherStation">
        select d.id,
        d.lon,
        d.lat,
        d.province,
        d.city,
        d.county,
        d.min_temperature,
        d.max_temperature,
        d.weather,
        d.site_code,
        d.site_name
        from a_weather_stations d
        <where>
            1=1
            <if test="longitude !=null and longitude !=''">
                and  lon=#{longitude}
            </if>
            <if test="latitude !=null and latitude !=''">
                and  lat=#{latitude}
            </if>
            <if test="siteCode !=null and siteCode !=''">
                and  site_code=#{siteCode}
            </if>
        </where>

    </select>
    <select id="getCityCode" resultType="java.lang.String">
        select city_code cityCode from a_weatherstation_interface
        <where>
            city_name=#{cityName}
        </where>


    </select>

</mapper>
