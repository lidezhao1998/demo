<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:include="include :: header('新增地面调查数据')"/>
    <th:block th:include="include :: datetimepicker-css"/>
    <th:block th:include="include :: bootstrap-fileinput-css"/>
    <th:block th:include="include :: select2-css"/>
    <th:block th:include="include :: bootstrap-select-css"/>
    <style type="text/css">
        .tg-0lax {
            text-align: center;
            vertical-align: middle;
            color: #333;
        }

        table {
            background-color: white;
            margin-left: 35px;
        }

        .col-sm-3 {
            color: #333;
        }

        .form-control {
            color: #333;
        }

        .form-group1 {
            margin-left: 80px;
        }

        .col-sm-pt {
            width: 95%;
        }

        .daohang {
            float: right;
            width: 120px;
            margin-right: 20px;

        }

        /*修改表头颜色*/
        .table-striped table thead {
            background-color: rgba(48, 146, 62, 0.9);
            color: whitesmoke;
            height: 55px;
        }
    </style>
</head>
<body class="white-bg">

<div class="wrapper wrapper-content animated fadeInRight ibox-content">
    <div class="container-div">
        <div class="row">
            <div class="col-sm-12 search-collapse">
                <button type="button" class="btn btn-outline btn-primary daohang" onclick="tuihui()">审核意见</button>
                <button type="button" class="btn btn-outline btn-primary daohang" onclick="jilu()">审核记录</button>
                <a class="btn btn-success" onclick="bjht()">
                    <i class="fa fa-plus"></i> 查看绘图
                </a>
            </div>

        </div>
    </div>


    <form class="form-horizontal" id="form-survey-add" th:object="${cGroundSurvey}">
        <input id="groundId" name="groundId" th:field="*{groundId}" type="hidden">
        <input id="photoUrl" name="photoUrl" th:field="*{photoUrl}" type="hidden">
        <input id="mapId" name="mapId" th:field="*{mapId}" type="hidden">

        <h4 class="form-header h4">样地基本信息</h4>
        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">样地编号：</label>
                    <div class="col-sm-8">
                        <div name="codeId" th:text="*{codeId}" class=" form-control-static">
                        </div>
                        <input name="codeId" th:field="*{codeId}" type="hidden">
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">省级名称：</label>
                    <div class="col-sm-8">
                        <div name="provincialLevelName" class="form-control-static"
                             th:text="${@dict.getLabel('sys_province', cGroundSurvey.provincialLevelName)}">
                        </div>
                        <input name="provincialLevelName" th:field="*{provincialLevelName}" type="hidden">
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">地级名称：</label>
                    <div class="col-sm-8">
                        <div name="cityLevelName" class="form-control-static"
                             th:text="${@dict.getLabels(cGroundSurvey.cityLevelName)}">
                        </div>
                        <input name="cityLevelName" th:field="*{cityLevelName}" type="hidden">
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">县级名称：</label>
                    <div class="col-sm-8">
                        <div name="countyLevelName" class="form-control-static"
                             th:text="${@dict.getLabels(cGroundSurvey.countyLevelName)}">
                        </div>
                        <input name="countyLevelName" th:field="*{countyLevelName}" type="hidden">
                    </div>
                </div>
            </div>
        </div>



        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">调查时间：</label>
                    <div class="col-sm-8">
                        <div class="input-group date">
                            <div name="surveyTime"
                                 th:text="${#dates.format(cGroundSurvey.surveyTime, 'yyyy-MM-dd HH:mm')}"
                                 class=" form-control-static">
                            </div>
                            <input name="surveyTime"
                                   th:value="${#dates.format(cGroundSurvey.surveyTime, 'yyyy-MM-dd HH:mm')}"
                                   class="form-control" placeholder="yyyy-MM-dd HH:mm" type="hidden">
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">调查人：</label>
                    <div class="col-sm-8" style="display: inline-block">
                        <div name="name" th:text="*{name}" class=" form-control-static">
                        </div>
                        <input name="name" th:field="*{name}" type="hidden">
                    </div>
                </div>
            </div>


        </div>


        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">土壤类型：</label>
                    <div class="col-sm-8">
                        <div name="soilType" class="form-control-static"
                             th:text="${@dict.getLabel('di_soil', cGroundSurvey.soilType)}">
                        </div>
                        <!--<input  name="soilType"  th:text="*{soilType}" type="hidden">-->
                        <!-- <input name="province" th:text="${@dict.getLabel('sys_normal_disable', soilType)}" class="form-control" type="text" required disabled="disabled">-->
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">草地类型：</label>
                    <div class="col-sm-8">
                        <div name="grasslandType" class="form-control-static"
                             th:text="${@dict.getLabel('di_grassland', cGroundSurvey.grasslandType)}">
                        </div>
                        <input name="grasslandType" th:field="*{grasslandType}" type="hidden">
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">植被覆盖度：</label>
                    <div class="col-sm-8">
                        <div name="vegetationCoverage" class="form-control-static" th:text="*{vegetationCoverage}">
                        </div>
                        <input name="vegetationCoverage" th:field="*{vegetationCoverage}" type="hidden">
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">地上生物量：</label>
                    <div class="col-sm-8">
                        <div name="aboveGroundBiomass" class="form-control-static" th:text="*{aboveGroundBiomass}">
                        </div>
                        <input name="aboveGroundBiomass" th:field="*{aboveGroundBiomass}" type="hidden">
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">天敌种类：</label>
                    <div class="col-sm-8">
                        <div name="naturalEnemyType" class="form-control-static"
                             th:text="${@dict.getLabel('di_natural_enemy', cGroundSurvey.naturalEnemyType)}"></div>
                    </div>
                    <!--<input  name="naturalEnemyType"  th:field="*{naturalEnemyType}" type="hidden">-->
                </div>
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">主要植物：</label>
                    <div class="col-sm-8">
                        <div name="mianBotanyType" class="form-control-static"
                             th:text="${@dict.getLabel('di_mian_botany', cGroundSurvey.mianBotanyType)}">
                        </div>
                        <input name="mianBotanyType" th:field="*{mianBotanyType}" type="hidden">
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">经度：</label>
                    <div class="col-sm-8">
                        <div name="longitude" class="form-control-static" th:text="*{longitude}"></div>
                        <input name="longitude" th:field="*{longitude}" type="hidden">
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">纬度：</label>
                    <div class="col-sm-8">
                        <div name="latitude" class="form-control-static" th:text="*{latitude}"></div>
                        <input name="latitude" th:field="*{latitude}" type="hidden">
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">地形：</label>
                    <div class="col-sm-8">
                        <div name="topographyType" class="form-control-static" th:text="*{topographyType}"></div>
                        <input name="topographyType" th:field="*{topographyType}" type="hidden">
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">坡位：</label>
                    <div class="col-sm-8">
                        <div name="slopePositionType" class="form-control-static"
                             th:text="*{slopePositionType}"></div>
                        <input name="slopePositionType" th:field="*{slopePositionType}" type="hidden">
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">坡向：</label>
                    <div class="col-sm-8">
                        <div name="asceptType" class="form-control-static" th:text="*{asceptType}"></div>
                        <input name="asceptType" th:field="*{asceptType}" type="hidden">
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">坡度：</label>
                    <div class="col-sm-8">
                        <div name="fallingGradient" class="form-control-static" th:text="*{fallingGradient}"></div>
                        <input name="fallingGradient" th:field="*{fallingGradient}" type="hidden">
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">高程：</label>
                    <div class="col-sm-8">
                        <div name="elevation" class="form-control-static" th:text="*{elevation}"></div>
                        <input name="elevation" th:field="*{elevation}" type="hidden">
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">地表特征：</label>
                    <div class="col-sm-8">
                        <div name="surfaceFeaturesType" class="form-control-static"
                             th:text="${@dict.getLabel('di_surface_features', cGroundSurvey.surfaceFeaturesType)}"></div>
                        <input name="surfaceFeaturesType" th:field="*{surfaceFeaturesType}" type="hidden">
                    </div>
                </div>
            </div>
        </div>
        <h4 class="form-header h4">样地照片</h4>
        <div class="row">
            <div class="col-sm-pt">
                <div class="form-group1">
                    <div class="file-loading">
                        <input id="fileinput-demo-2" name="photo" type="file" multiple>

                    </div>
                </div>
            </div>
        </div>
        <h4 class="form-header h4">取样信息</h4>
        <div class="col-sm-12 select-table table-striped">

            <table id="bootstrap-table3"></table>
        </div>


        <h4 class="form-header h4">审核意见</h4>

        <div class="row">
            <div class="col-sm-9">
                <div class="form-group">
                    <label class="col-sm-2 control-label">意见内容：</label>
                    <div class="col-sm-10">
                        <input name="flowIdea.id" th:field="*{flowIdea.id}" type="hidden">
                        <input name="flowIdea.uniqueid" th:field="*{flowIdea.uniqueid}" type="hidden">
                        <textarea id="ideatext" name="flowIdea.idea" style="height: 90px"
                                  class="form-control ideatextarea" th:field="*{flowIdea.idea}"></textarea>
                    </div>
                </div>
            </div>

        </div>
        <div class="col-sm-offset-5 col-sm-10" th:switch="*{staute}" style="display:inline">
            <button type="button" class="btn btn-sm btn-primary" th:onclick="submitHandler1()" th:case="'退回'"><i
                    class="fa fa-check"></i>提 交
            </button>
            <div th:case="*" style="display:inline">
                <button type="button" class="btn btn-sm btn-primary" th:onclick="check()"><i
                        class="fa fa-check"></i>审核通过
                </button>&nbsp;
                <button type="button" class="btn btn-sm btn-primary" th:onclick="back()"><i class="fa fa-check"></i>退
                    回
                </button>&nbsp;
            </div>
            <button type="button" class="btn btn-sm btn-danger" onclick="closeItem111()"><i
                    class="fa fa-reply-all"></i>关 闭
            </button>
        </div>
    </form>
</div>
<th:block th:include="include :: footer"/>
<th:block th:include="include :: jquery-steps-js"/>
<th:block th:include="include :: datetimepicker-js"/>
<th:block th:include="include :: bootstrap-fileinput-js"/>
<th:block th:include="include :: select2-js"/>
<th:block th:include="include :: bootstrap-select-js"/>
<script th:inline="javascript">
    var prefix = ctx + "caiji/survey";
    $("#form-survey-add").validate({
        focusCleanup: true
    });

    function addTab3(obj) {
        $(obj).parent().parent().parent().remove();
    }

    function addTab2() {
        var tableNode = document.getElementById("bootstrap-table");
        var trNodeList = tableNode.getElementsByTagName("tr");
        //得到最后一行(tr)的所有td
        var tdNodeList = trNodeList[trNodeList.length - 1].getElementsByTagName("td");
        var td_input_name = tdNodeList[0].getElementsByTagName("input")[0].name;
        var strIndex = td_input_name.indexOf("[");
        var number = td_input_name.substring(strIndex + 1, strIndex + 2);

        var trNode = document.createElement("tr");
        number++;
        var year = $("#yea").val();
        $("#bootstrap-table").append(" <tbody><tr >\n" +
            "                        <td class=\"tg-lboi\">\n" +
            "                            <input name=\"cPlotList[" + number + "].samplingArea\" class=\"form-control\" type=\"text\">\n" +
            "                        </td>\n" +
            "                        <td class=\"tg-lboi\">\n" +
            "                            <select name=\"cPlotList[" + number + "].harmfulSpeciesType\" class=\"form-control \">\n" +
            "                                <option value=\"\">所有</option>\n" +
            "                            </select>\n" +
            "                        </td>\n" +
            "                        <td class=\"tg-lboi\">\n" +
            "                            <input name=\"cPlotList[" + number + "].quantityDetermination\" class=\"form-control\" type=\"text\">\n" +
            "                        </td>\n" +
            "                        <td class=\"tg-lboi\">\n" +
            "                            <input name=\"cPlotList[" + number + "].standardDensity\" class=\"form-control\" type=\"text\">\n" +
            "                        </td>\n" +
            "                        <td class=\"tg-lboi\">\n" +
            "                            <input name=\"cPlotList[" + number + "].standardDensity\" class=\"form-control\" type=\"text\">\n" +
            "                        </td>\n" +
            "                        <td class=\"tg-lboi\">\n" +
            "                            <div class=\"tg-lboi\">\n" +
            "                                <a class=\"btn btn-success\" onclick=\"addTab1()\" >\n" +
            "                                    <i class=\"fa fa-plus\"></i> 上传\n" +
            "                                   <input id=number  name=\"cPlotList[\"+number+\"].photo\" class=\"form-control\" type=\"hidden\">\n" +
            "                                </a>\n" +
            "                            </div>\n" +
            "                        </td>  <td class=\"tg-lboi\">\n" +
            "                            <div class=\"tg-lboi\">\n" +
            "                                <a class=\"btn btn-danger multiple \" onclick=\"addTab3(this)\" >\n" +
            "                                    <i class=\"fa fa-remove\"></i> 删除\n" +
            "                                </a>\n" +
            "                            </div>\n" +
            "                        </td>\n" +
            "                    </tr></tbody>")

    }

    //保存地面调查数据
    function submitHandler() {
        if ($.validate.form()) {
            $.operate.save(prefix + "/add", $('#form-survey-add').serialize());
        }
    }

    //
    function check() {
        $.operate.save(prefix + "/check", $('#form-survey-add').serialize());
    }

    //地面调查数据提交
    function tuihui() {
        var id = $("#groundId").val();
        // alert(id);
        layer.open({
            type: 2,
            area: ["900px", '600px'],
            fix: false,
            //不固定
            maxmin: true,
            shade: 0.3,
            title: "填写意见",
            content: prefix + "/idea/" + id,
            btn: ['确定', '关闭'],
            yes: function (index, layero) {
                var iframeWin = layero.find('iframe')[0];
                /*  var code=iframeWin.contentWindow.chuanzhi();
                  if(code==false){

                  }else{
                      $("#codeId").val(code);
                      layer.close(index);
                  }*/
                layer.close(index);
            },
            cancel: function (index) {
                return true;
            }
        });
        //$.operate.save(prefix + "/back", $('#form-survey-add').serialize());

    }

    function addTab1(val) {
        var id = $("#" + val).val();
        $.modal.openFull("查看取样照片", prefix + "/quuploadview?idx=" + val + "&idp=" + id,
            shadeClose = false)
    }

    $("input[name='surveyTime']").datetimepicker({
        format: "yyyy-mm-dd",
        minView: "month",
        autoclose: true
    });

    function back() {
        var idea = $("#ideatext").val().replace(/^\s+|\s+$/g, "");
        if (idea != null && idea != "") {
            $.operate.save(prefix + "/back", $('#form-survey-add').serialize());
        } else {
            $.modal.alert("请填写退回意见！")
        }


    }

    /*  var preList = new Array();
      var listImage = selectItem.FImage.split(",");
      var listFUrl = selectItem.FUrl;
      var previewJson = preList;
      var initPreviewConfig = new Array();*/
    var obj = document.getElementById("photoUrl");//储存图图片id
    var ids = [];
    var initialPreview = [[${initialPreview}]];
    var initialPreviewConfig = [[${initialPreviewConfig}]];
    $("#fileinput-demo-2").fileinput({
        'theme': 'explorer-fas',
        'uploadUrl': prefix + '/upload',
        deleteUrl: prefix + '/delete',
        overwriteInitial: false,
        uploadIcon: "<i class=\"glyphicon glyphicon-upload\"></i>",
        initialPreviewAsData: true,
        uploadAsync: true,
        showUpload: false,
        allowedFileExtensions: ['jpg', 'gif', 'png', 'bmp', 'jpeg'],//指出带有哪些后缀名的文件才是被接受上传的
        previewFileIcon: '',//当文件无法被预览时出现在缩略图中的图标，默认是
        maxFileCount: 10,
        layoutTemplates: {
            actionUpload: ""
        },
        deleteExtraData: {
            files: "111111111"
        },
        initialPreview: initialPreview,
        initialPreviewConfig: initialPreviewConfig,


    });
    $('#fileinput-demo-2').fileinput('disable');
    $(".kv-file-remove").click(function () {

        alert("target" + JSON.stringify($(this).target));
    });
    /*$('#fileinput-demo-2').on('filepredelete', function(event,data,jax,key) {
         alert("key"+JSON.stringify(key));
         alert("data"+JSON.stringify(data));
         alert("jax"+JSON.stringify(jax));
         alert("event"+JSON.stringify(event));
         console.log('Key = ' + key);

     });*/


    $("#fileinput-demo-2").on("fileuploaded", function (event, data, previewId, index) {
        initialPreview.push(data.response.initialPreview)
        var obj = {
            caption: data.response.filename,
            size: data.response.size,
            url: prefix + '/delete',
            key: data.response.id,
        }
        alert(JSON.stringify(obj));
        initialPreviewConfig.push(obj);
        alert(JSON.stringify(initialPreview));
        if (ids.length == 0) {
            ids = data.response.id;
        } else {
            ids = ids + "," + data.response.id;
        }
        var idsarry = ids.split(",");
        ids = evlabc(idsarry);
        obj.value = ids;
        $('#fileinput-demo-2').fileinput('destroy');
        $("#fileinput-demo-2").fileinput({
            'theme': 'explorer-fas',
            'uploadUrl': prefix + '/upload',
            overwriteInitial: false,
            uploadIcon: "<i class=\"glyphicon glyphicon-upload\"></i>",
            initialPreviewAsData: true,
            uploadAsync: true,
            allowedFileExtensions: ['jpg', 'gif', 'png', 'bmp', 'jpeg'],//指出带有哪些后缀名的文件才是被接受上传的
            previewFileIcon: '',//当文件无法被预览时出现在缩略图中的图标，默认是
            maxFileCount: 10,
            layoutTemplates: {
                actionUpload: "",
                actionDelete: "",
            },
            deleteExtraData: {
                files: "111111111"
            },
            initialPreview: initialPreview,
            initialPreviewConfig: initialPreviewConfig,


        })
        $('#fileinput-demo-2').fileinput('enable');

    });

    function dianji() {
        /*alert(initialPreview);
        alert(JSON.stringify(initialPreviewConfig));
        alert($("#photoUrl").val());*/
    }

    //数组排序方法
    function evlabc(a) { //排序大小
        var i = j = t = 0;
        for (i = 0; i < a.length; i++) {
            for (j = 0; j < a.length; j++) {
                if (a[i] < a[j]) {// 相邻元素两两对比
                    t = a[i];
                    a[i] = a[j];
                    a[j] = t;
                }
            }
        }
        return a;
    }

    //取值在数组中的下标
    function indexOfArry(arry, val) {
        for (var i = 0; i < arry.length; i++) {
            if (arry[i] == val) return i;
        }
        return -1;
    };

    //删除数组中固定的值
    function removearry(arry, val) {
        var index = indexOfArry(arry, val);
        if (index > -1) {
            arry.splice(index, 1);
        }
    };


    layui.use('laydate', function () {
        var laydate = layui.laydate;

        laydate.render({
            elem: '#laydate-demo-1'
        });

        laydate.render({
            elem: '#laydate-demo-2',
            type: 'date'
        });

        laydate.render({
            elem: '#laydate-demo-3',
            type: 'datetime',
            trigger: 'click'
        });

        laydate.render({
            elem: '#laydate-demo-4',
            range: true
        });

        var startDate = laydate.render({
            elem: '#laydate-startTime',
            max: $('#laydate-endTime').val(),
            theme: 'molv',
            trigger: 'click',
            done: function (value, date) {
                // 结束时间大于开始时间
                if (value !== '') {
                    endDate.config.min.year = date.year;
                    endDate.config.min.month = date.month - 1;
                    endDate.config.min.date = date.date;
                } else {
                    endDate.config.min.year = '';
                    endDate.config.min.month = '';
                    endDate.config.min.date = '';
                }
            }
        });

        var endDate = laydate.render({
            elem: '#laydate-endTime',
            min: $('#laydate-startTime').val(),
            theme: 'molv',
            trigger: 'click',
            done: function (value, date) {
                // 开始时间小于结束时间
                if (value !== '') {
                    startDate.config.max.year = date.year;
                    startDate.config.max.month = date.month - 1;
                    startDate.config.max.date = date.date;
                } else {
                    startDate.config.max.year = '';
                    startDate.config.max.month = '';
                    startDate.config.max.date = '';
                }
            }
        });
    });

    function closeItem111() {
        $.modal.closeTab();
    }

    //地面调查数据提交
    function submitHandler1() {
        if ($.validate.form()) {
            $.operate.save(prefix + "/add1", $('#form-survey-add').serialize());
        }
    }


    $(function () {
        var prefix1 = ctx + "caiji/plot";

        var options = {
            id: "bootstrap-table3",
            url: prefix1 + "/list",
            createUrl: prefix1 + "/add",
            detailUrl: prefix1 + "/samplingDetail/{id}",
            pageList: [3, 6, 9],//分页步进值
            pageSize: 3,
            showRefresh: false,
            showColumns: false,
            showToggle: false,
            showExport: false,
            showSearch: false,
            modalName: "取样数据",
            columns: [
                /* {
                     field: 'id',
                     title: '序号',
                     width:5 ,
                     align: 'center',
                     valign: 'middle',
                     switchable:false,
                     formatter:function(value,row,index){
                         //return index+1; //序号正序排序从1开始
                         var pageSize=$('#bootstrap-table3').bootstrapTable('getOptions').pageSize;//通过表的#id 可以得到每页多少条
                         var pageNumber=$('#bootstrap-table3').bootstrapTable('getOptions').pageNumber;//通过表的#id 可以得到当前第几页
                         return pageSize * (pageNumber - 1) + index + 1;    //返回每条的序号： 每页条数 * （当前页 - 1 ）+ 序号
                     }
                 },*/
                {
                    field: 'samplingNumber',
                    align: 'center',
                    valign: 'middle',
                    title: '取样编号'
                },
                {
                    field: 'samplingArea',
                    align: 'center',
                    valign: 'middle',
                    title: '取样面积类型'
                },
                {
                    field: 'harmfulSpeciesType',
                    align: 'center',
                    valign: 'middle',
                    title: '有害生物种类'
                },
                {
                    field: 'detailedType',
                    align: 'center',
                    valign: 'middle',
                    title: '具体种类'
                },
                {
                    field: 'quantityDetermination',
                    align: 'center',
                    valign: 'middle',
                    title: '测定数量'
                },
                /* {
                     field : 'photo',
                     align: 'center',
                     valign: 'middle',
                     title : '照片'
                 },*/
                /*{
                    field : 'status',
                    align: 'center',
                    valign: 'middle',
                    title : '状态'
                },*/
                {
                    title: '操作',
                    align: 'center',
                    valign: 'middle',
                    formatter: function (value, row, index) {
                        var actions = [];
                        actions.push('<a class="btn btn-info btn-xs" href="javascript:void(0)" onclick="$.operate.detail(\'' + row.plotId + '\')"><i class="fa fa-search"></i>详情</a> ');
                        return actions.join('');
                    }
                }
            ]
        };
        $.table.init(options);
    });


    function bjht() {
        var mapId = $("#mapId").val();
        if (mapId == "") {
            layer.alert("本条信息无绘图")
        } else {
            var prefix = ctx + "system/gisMap";

            var url = prefix + '/getckListCaoYuanGisMap/' + mapId;
            $.modal.open("查看绘图", url, '680', '550');
        }

    }

    /*  function hiddenht() {
          let gis_id = sessionStorage.getItem("gis_id");
          var mapId=gis_id;
          var prefix = ctx + "system/gisMap";
          var url = prefix + '/getGisMap/' + mapId;
          //var url = prefix + '/getckListCaoYuanGisMap/'+mapId;
          $.modal.open("查看绘图", url, '850', '650');

      }*/


    function jilu() {
        var id = $("#groundId").val();
        // alert(id);
        layer.open({
            type: 2,
            area: ["900px", '600px'],
            fix: false,
            //不固定
            maxmin: true,
            shade: 0.3,
            title: "流程记录",
            content: prefix + "/flowlog/" + id + "/1",
            btn: ['确定', '关闭'],
            yes: function (index, layero) {
                var iframeWin = layero.find('iframe')[0];
                /*  var code=iframeWin.contentWindow.chuanzhi();
                  if(code==false){

                  }else{
                      $("#codeId").val(code);
                      layer.close(index);
                  }*/
                layer.close(index);
            },
            cancel: function (index) {
                return true;
            }
        });
        //$.operate.save(prefix + "/back", $('#form-survey-add').serialize());

    }
</script>

</body>
</html>